#!/bin/bash

# Ensure we are on the main branch before bumping version
current_branch=$(git rev-parse --abbrev-ref HEAD)
if [ "$current_branch" != "main" ]; then
  echo "Version bump only on main branch. Skipping."
  exit 0
fi

# Bump version in package.json without creating a commit or tag yet
new_version_v=$(npm version minor)
new_version=${new_version_v#v}

# Create the commit and tag
git add package.json
git commit -m "bump version to $new_version"
git tag "$new_version_v"

echo "Version bumped to $new_version. The new commit and tag will be pushed."
echo "To push both the commit and the tag, you might need to use: git push --follow-tags"

exit 0
